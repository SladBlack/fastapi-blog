{% extends "base.html" %}

{% block content %}

<div align="center">
    <nav>
        {% if user %}
        <a href="/create_post">Создать пост</a>
        <a href="/profile">Профиль</a>
        <a href="/auth/logout">Выйти</a>
        {% else %}
        <a href="/auth/sign-in/">Вход</a>
        <a href="/auth/register/">Регистрация</a>
        {% endif %}
    </nav>
</div>


{% for post in posts %}
<div class="container">
    <div class="row">
        <div class="post">
            <h3>{{ post.title }}</h3>
            <p class="post_info">Дата публикации: {{ post.created_at.strftime('%Y-%m-%d %H:%m') }}</p>
            <a href="/{{ post.id }}">Посмотреть полностью</a>
            {% if post.user_id == user.id %}
            <a href="/update/{{ post.id }}">Редактировать</a>
            <form action="/{{ post.id }}/delete" method="POST">
                <input type="submit" value="Удалить"/>
            </form>
            {% else %}
            {% endif %}

            {% if user %}
            <form action="/{{ post.id }}/like" method="POST">
                {% if post.likes.post_id == post.id %}
                <input type="submit" value="Мне нравится"/>
                {% else %}
                <input type="submit" value="Мне не нравится"/>
                {% endif %}
            </form>
            {% endif %}

            <div class="post_info">
                <p>Отметок "Мне нравится": {{ post.likes|length }}</p>
                <p>Просмотров: {{ post.view_count }}</p>
            </div>

        </div>
    </div>
</div>

{% endfor %}

{% endblock %}


{% with msg=msg %}
{% include "components/alerts.html" %}
{% endwith %}